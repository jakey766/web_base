!function(a){a.fn.columnFilter=function(b){function n(a,b,c,d,e){if("undefined"==typeof b)return new Array;"undefined"==typeof c&&(c=!0),"undefined"==typeof d&&(d=!0),"undefined"==typeof e&&(e=!0);var f;f=1==d?a.aiDisplay:a.aiDisplayMaster;for(var g=new Array,h=0,i=f.length;i>h;h++){var j=f[h],k=x.fnGetData(j),l=k[b];(1!=e||0!=l.length)&&(1==c&&jQuery.inArray(l,g)>-1||g.push(l))}return g.sort()}function o(a){return z.bUseColVis?a:x.fnSettings().oApi._fnVisibleToColumnIndex(x.fnSettings(),a)}function p(b,g,h,i,j,k){var l="text_filter";i&&(l="number_filter"),e=e.replace(/(^\s*)|(\s*$)/g,"");var n=b.fnSettings().aoPreSearchCols[d].sSearch,p="search_init ",q=e;""!=n&&"^"!=n&&(q=i&&"^"==n.charAt(0)?n.substr(1):n,p="");var r=a('<input type="text" class="'+p+l+'" value="'+q+'" rel="'+d+'"/>');void 0!=k&&-1!=k&&r.attr("maxlength",k),f.html(r),i?f.wrapInner('<span class="filter_column filter_number" />'):f.wrapInner('<span class="filter_column filter_text" />'),c[d]=e;var s=d;i&&!b.fnSettings().oFeatures.bServerSide?r.keyup(function(){b.fnFilter("^"+this.value,o(s),!0,!1),m()}):r.keyup(function(){if(b.fnSettings().oFeatures.bServerSide&&0!=j){b.fnSettings().aoPreSearchCols[s].sSearch;var d=a(this).data("dt-iLastFilterLength");"undefined"==typeof d&&(d=0);var e=this.value.length;if(Math.abs(e-d)<j)return;a(this).data("dt-iLastFilterLength",e)}b.fnFilter(this.value,o(s),g,h),m()}),r.focus(function(){a(this).hasClass("search_init")&&(a(this).removeClass("search_init"),this.value="")}),r.blur(function(){""==this.value&&(a(this).addClass("search_init"),this.value=c[s])})}function q(b){f.html(w(0));var c=b.attr("id")+"_range_from_"+d,e=a('<input type="text" class="number_range_filter" id="'+c+'" rel="'+d+'"/>');f.append(e),f.append(w(1));var g=b.attr("id")+"_range_to_"+d,h=a('<input type="text" class="number_range_filter" id="'+g+'" rel="'+d+'"/>');f.append(h),f.append(w(2)),f.wrapInner('<span class="filter_column filter_number_range" />');var j=d;i.push(d),b.dataTableExt.afnFiltering.push(function(a,d){if(b.attr("id")!=a.sTableId)return!0;if(null==document.getElementById(c))return!0;var f=1*document.getElementById(c).value,h=1*document.getElementById(g).value,i="-"==d[o(j)]?0:1*d[o(j)];return""==f&&""==h?!0:""==f&&h>=i?!0:i>=f&&""==h?!0:i>=f&&h>=i?!0:!1}),a("#"+c+",#"+g,f).keyup(function(){var a=1*document.getElementById(c).value,d=1*document.getElementById(g).value;0!=a&&0!=d&&a>d||(b.fnDraw(),m())})}function r(b){var c=g.split(/[}{]/);f.html("");var e=b.attr("id")+"_range_from_"+d,h=a('<input type="text" class="date_range_filter" id="'+e+'" rel="'+d+'"/>');h.datepicker();var j=b.attr("id")+"_range_to_"+d,k=a('<input type="text" class="date_range_filter" id="'+j+'" rel="'+d+'"/>');for(ti=0;ti<c.length;ti++)c[ti]==z.sDateFromToken?f.append(h):c[ti]==z.sDateToToken?f.append(k):f.append(c[ti]);f.wrapInner('<span class="filter_column filter_date_range" />'),k.datepicker();var l=d;i.push(d),b.dataTableExt.afnFiltering.push(function(c,d){if(b.attr("id")!=c.sTableId)return!0;var f=h.datepicker("getDate"),g=k.datepicker("getDate");if(null==f&&null==g)return!0;var i=null;try{if(null==d[o(l)]||""==d[o(l)])return!1;i=a.datepicker.parseDate(a.datepicker.regional[""].dateFormat,d[o(l)])}catch(j){return!1}return null==i?!1:null==f&&g>=i?!0:i>=f&&null==g?!0:i>=f&&g>=i?!0:!1}),a("#"+e+",#"+j,f).change(function(){b.fnDraw(),m()})}function s(b,c,e,f,g,h,i){null==c&&(c=n(b.fnSettings(),e,!0,!1,!0));var k=b.fnSettings().aoPreSearchCols[d].sSearch;(null==k||""==k)&&(k=i);var l='<select class="search_init select_filter" rel="'+d+'"><option value="" class="search_init">'+g+"</option>",o=0,p=c.length;for(o=0;p>o;o++)if("object"!=typeof c[o]){var q="";(escape(c[o])==k||escape(c[o])==escape(k))&&(q="selected "),l+="<option "+q+' value="'+escape(c[o])+'">'+c[o]+"</option>"}else{var q="";h?(c[o].value==k&&(q="selected "),l+="<option "+q+'value="'+c[o].value+'">'+c[o].label+"</option>"):(escape(c[o].value)==k&&(q="selected "),l+="<option "+q+'value="'+escape(c[o].value)+'">'+c[o].label+"</option>")}var r=a(l+"</select>");f.html(r),f.wrapInner('<span class="filter_column filter_select" />'),r.change(function(){""!=a(this).val()?a(this).removeClass("search_init"):a(this).addClass("search_init"),h?b.fnFilter(a(this).val(),e,h):b.fnFilter(unescape(a(this).val()),e),m()}),null!=k&&""!=k&&b.fnFilter(unescape(k),e)}function t(a,b,c,g){var h=a.fnSettings();null!=b||""==h.sAjaxSource||h.oFeatures.bServerSide||h.aoDrawCallback.push({fn:function(b,d,e){return function(){return 2!=h.iDraw||null==h.sAjaxSource||""==h.sAjaxSource||h.oFeatures.bServerSide?void 0:s(a,null,o(b),d,e,c,g)}}(d,f,e),sName:"column_filter_"+d}),s(a,b,o(d),f,e,c,g)}function u(b){var h,c=d,g='<div class="dropdown select_filter"><a class="dropdown-toggle" data-toggle="dropdown" href="#">'+e+'<b class="caret"></b></a><ul class="dropdown-menu" role="menu"><li data-value=""><a>Show All</a></li>',i=b.length;for(h=0;i>h;h++)g+='<li data-value="'+b[h]+'"><a>'+b[h]+"</a></li>";var j=a(g+"</ul></div>");f.html(j),f.wrapInner('<span class="filterColumn filter_select" />'),j.find("li").click(function(){x.fnFilter(a(this).data("value"),c)})}function v(b,c){null==c&&(c=n(b.fnSettings(),d,!0,!0,!0));var i,g=d,h="",j=c.length,k=e.replace("%","Perc").replace("&","AND").replace("$","DOL").replace("\xa3","STERL").replace("@","AT").replace(/\s/g,"_");k=k.replace(/[^a-zA-Z 0-9]+/g,"");var l=e;(null!=z.sFilterButtonText||void 0!=z.sFilterButtonText)&&(l=z.sFilterButtonText);var o=10,p=12,q=Math.floor(j/p);j%p>0&&(q+=1);var r=100/q-2,s=o*q;1==q&&(r=20);var t='<div style="float:none; min-width: '+r+'%; " >',u="</div>",v=b.attr("id")+k,w="chkBtnOpen"+v,x=v+"-flt-toggle";for(h+='<button id="'+w+'" class="checkbox_filter" > '+l+"</button>",h+='<div id="'+x+'" '+'title="'+e+'" '+'rel="'+d+'" '+'class="toggle-check ui-widget-content ui-corner-all"  style="width: '+s+'%; " >',h+=t,i=0;j>i;i++){0==i%p&&0!=i&&(h+=u+t);var y=c[i],A=c[i];"object"==typeof c[i]&&(y=c[i].label,A=c[i].value),h+='<label for="'+v+"_cb_"+A+'"><input class="search_init checkbox_filter" checked type="checkbox" id= "'+v+"_cb_"+A+'" name= "'+k+'" value="'+A+'" ><span style="display:inline-block; margin:3px 0 0 5px; vertical-align: middle;">'+y+"</span></label>";var B=a(h);f.html(B),f.wrapInner('<span class="filter_column filter_checkbox" />'),B.change(function(){var c="",d="|",e=a('input:checkbox[name="'+k+'"]:checked').size();a('input:checkbox[name="'+k+'"]:checked').each(function(b){(0==b&&1==e||0!=b&&b==e-1)&&(d=""),c=c.replace(/^\s+|\s+$/g,""),c=c+a(this).val()+d,d="|"}),""!=c?a('input:checkbox[name="'+k+'"]').removeClass("search_init"):a('input:checkbox[name="'+k+'"]').addClass("search_init"),b.fnFilter(c,g,!0,!1),m()})}a("#"+w).button(),a("#"+x).dialog({height:350,autoOpen:!1,hide:"clip",buttons:[{text:"\u5168\u4e0d\u9009",click:function(){return a('input:checkbox[name="'+k+'"]').each(function(){a(this).prop("checked",!1),a(this).addClass("search_init")}),b.fnFilter("",g,!0,!1),m(),!1}},{text:"\u5168\u9009",click:function(){return a('input:checkbox[name="'+k+'"]').each(function(){a(this).prop("checked",!0),a(this).addClass("search_init")}),b.fnFilter("",g,!0,!1),m(),!1}},{text:"\u5173\u95ed",click:function(){a(this).dialog("close")}}]}),a("#"+w).click(function(){a("#"+x).dialog("open");var b=a(this);return a("#"+x).dialog("widget").position({my:"left top",at:"left bottom",of:b}),!1});var C=m;m=function(){var b=a("#"+w);a("#"+x).dialog("widget").position({my:"left top",at:"left bottom",of:b}),C()}}function w(a){switch(a){case 0:return g.substring(0,g.indexOf("{from}"));case 1:return g.substring(g.indexOf("{from}")+6,g.indexOf("{to}"));default:return g.substring(g.indexOf("{to}")+4)}}var c,d,e,f,g="From {from} to {to}",h=new Array,i=new Array,m=function(){},x=this,y={sPlaceHolder:"foot",sRangeSeparator:"~",iFilteringDelay:500,aoColumns:null,sRangeFormat:"From {from} to {to}",sDateFromToken:"from",sDateToToken:"to"},z=a.extend(y,b);return this.each(function(){if(x.fnSettings().oFeatures.bFilter){c=new Array;var b=x.fnSettings().aoFooter[0],l=x.fnSettings().nTFoot,m="tr";if("head:after"==z.sPlaceHolder){var n=a("tr:first",x.fnSettings().nTHead).detach();x.fnSettings().bSortCellsTop?(n.prependTo(a(x.fnSettings().nTHead)),b=x.fnSettings().aoHeader[1]):(n.appendTo(a(x.fnSettings().nTHead)),b=x.fnSettings().aoHeader[0]),m="tr:last",l=x.fnSettings().nTHead}else if("head:before"==z.sPlaceHolder){if(x.fnSettings().bSortCellsTop){var n=a("tr:first",x.fnSettings().nTHead).detach();n.appendTo(a(x.fnSettings().nTHead)),b=x.fnSettings().aoHeader[1]}else b=x.fnSettings().aoHeader[0];m="tr:first",l=x.fnSettings().nTHead}for(a(b).each(function(b){d=b;var c={type:"text",bRegex:!1,bSmart:!0,iMaxLenght:-1,iFilterLength:0};if(null!=z.aoColumns){if(z.aoColumns.length<d||null==z.aoColumns[d])return;c=z.aoColumns[d]}if(e=a(a(this)[0].cell).text(),null==c.sSelector?f=a(a(this)[0].cell):(f=a(c.sSelector),0==f.length&&(f=a(a(this)[0].cell))),null!=c)switch(g=null!=c.sRangeFormat?c.sRangeFormat:z.sRangeFormat,c.type){case"null":break;case"number":p(x,!0,!1,!0,c.iFilterLength,c.iMaxLenght);break;case"select":1!=c.bRegex&&(c.bRegex=!1),t(x,c.values,c.bRegex,c.selected);break;case"number-range":q(x);break;case"date-range":r(x);break;case"checkbox":v(x,c.values);break;case"twitter-dropdown":case"dropdown":u(c.values);break;case"text":default:bRegex=null==c.bRegex?!1:c.bRegex,bSmart=null==c.bSmart?!1:c.bSmart,p(x,bRegex,bSmart,!1,c.iFilterLength,c.iMaxLenght)}}),j=0;j<i.length;j++){var o=function(){var b=x.attr("id");return a("#"+b+"_range_from_"+i[j]).val()+z.sRangeSeparator+a("#"+b+"_range_to_"+i[j]).val()};h.push(o)}if(x.fnSettings().oFeatures.bServerSide){var s=x.fnSettings().fnServerData;x.fnSettings().fnServerData=function(b,c,d){for(j=0;j<i.length;j++){var e=i[j];for(k=0;k<c.length;k++)c[k].name=="sSearch_"+e&&(c[k].value=h[j]())}if(c.push({name:"sRangeSeparator",value:z.sRangeSeparator}),null!=s)try{s(b,c,d,x.fnSettings())}catch(f){s(b,c,d)}else a.getJSON(b,c,function(a){d(a)})}}}})}}(jQuery);